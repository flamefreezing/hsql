<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="org.freezing.naive.repository.ReservationRepository">


<select id="getReservationHistory" resultType="org.freezing.naive.dto.GetReservationHistoryOutDto">
		<![CDATA[
		    SELECT 
		    R.ID, 
		    R.START_TIME, 
		    R.END_TIME, 
		    R.STATUS, 
		    S.NAME, 
		    F.FLOOR, 
		    B.NAME 
		FROM 
		    RESERVATION R 
		JOIN 
		    SEAT S ON R.SEAT_ID = S.ID 
		JOIN 
		    FLOOR F ON S.FLOOR_ID = F.ID 
		JOIN 
		    BUILDING B ON F.BUILDING_ID = B.ID 
		WHERE 
		    R.START_TIME < #{endTime} 
		    AND R.END_TIME > #{startTime}
		OFFSET #{skip}
		LIMIT ${limit}
		]]>
    </select>

</mapper>
